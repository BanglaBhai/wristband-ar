<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Talash WristBand AR</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    
    <style>
      body { margin: 0; overflow: hidden; }
      .a-canvas { width: 100% !important; height: 100% !important; }

      #example-scanning-overlay {
        position: absolute; left: 0; right: 0; top: 0; bottom: 0;
        display: flex; align-items: center; justify-content: center;
        background: rgba(0, 0, 0, 0.7); color: white; z-index: 2;
        font-family: sans-serif; transition: opacity 0.5s;
      }
      #example-scanning-overlay.hidden { opacity: 0; pointer-events: none; }

      #ui-container {
        position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%);
        display: flex; gap: 30px; z-index: 10;
      }
      .color-btn {
        width: 60px; height: 60px; border-radius: 50%; border: 4px solid white;
        cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      }
      #btn-white { background-color: #ffffff; }
      #btn-pink { background-color: #ff4081; }
    </style>
  </head>

  <body>
    <div id="example-scanning-overlay">
      <p>Scan the flyer...!</p>
    </div>

    <div id="ui-container">
      <div id="btn-white" class="color-btn" onclick="switchModel('white')"></div>
      <div id="btn-pink" class="color-btn" onclick="switchModel('pink')"></div>
    </div>

    <a-scene 
      mindar-image="imageTargetSrc: ./targets.mind; filterMinCF:0.0001; filterBeta: 0.001; uiScanning: no;" 
      color-space="sRGB" 
      renderer="colorManagement: true, physicallyCorrectLights: false" 
      vr-mode-ui="enabled: false" 
      device-orientation-permission-ui="enabled: false">
      
      <a-assets>
        <a-asset-item id="white-asset" src="./wristband.glb"></a-asset-item>
        <a-asset-item id="pink-asset" src="./wristband_alt.glb"></a-asset-item>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-light type="ambient" intensity="1"></a-light>
      <a-light type="directional" position="1 2 1" intensity="0.7"></a-light>

      <a-entity mindar-image-target="targetIndex: 0" class="target-anchor">
        <a-entity class="showroom-wrapper" position="0 0 0.3" rotation="50 0 0"
                  animation="property: rotation; from: 50 0 0; to: 50 0 360; dur: 5000; easing: linear; loop: true">
          
          <a-gltf-model class="white-model" src="#white-asset" scale="0.1 0.1 0.1" visible="true"></a-gltf-model>
          <a-gltf-model class="pink-model" src="#pink-asset" scale="0.1 0.1 0.1" visible="false"></a-gltf-model>
          
        </a-entity>
      </a-entity>

      <a-entity mindar-image-target="targetIndex: 1" class="target-anchor">
        <a-entity class="showroom-wrapper" position="0 0 0.3" rotation="50 0 0"
                  animation="property: rotation; from: 50 0 0; to: 50 0 360; dur: 5000; easing: linear; loop: true">
          
          <a-gltf-model class="white-model" src="#white-asset" scale="0.1 0.1 0.1" visible="true"></a-gltf-model>
          <a-gltf-model class="pink-model" src="#pink-asset" scale="0.1 0.1 0.1" visible="false"></a-gltf-model>
          
        </a-entity>
      </a-entity>
    </a-scene>

    <script>
      const overlay = document.querySelector('#example-scanning-overlay');
      const anchors = document.querySelectorAll('.target-anchor');

      // Detect Found/Lost
      anchors.forEach(anchor => {
        anchor.addEventListener("targetFound", () => {
          overlay.classList.add('hidden');
        });
        anchor.addEventListener("targetLost", () => {
          overlay.classList.remove('hidden');
        });
      });

      // BUTTON FIX: Toggle visibility instead of changing SRC
      function switchModel(color) {
        const whiteModels = document.querySelectorAll('.white-model');
        const pinkModels = document.querySelectorAll('.pink-model');
        
        if (color === 'white') {
          whiteModels.forEach(m => m.setAttribute('visible', 'true'));
          pinkModels.forEach(m => m.setAttribute('visible', 'false'));
        } else {
          whiteModels.forEach(m => m.setAttribute('visible', 'false'));
          pinkModels.forEach(m => m.setAttribute('visible', 'true'));
        }
      }
    </script>
  </body>
</html>




